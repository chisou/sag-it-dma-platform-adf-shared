{
	"name": "IngestSalesforceLeadsToStagingInDaily",
	"properties": {
		"folder": {
			"name": "Salesforce"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "SalesforceLeadFromBlob",
						"type": "DatasetReference"
					},
					"name": "SalesforceLeadsFromBlob"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "StgSfLeadToStagingIn",
						"type": "DatasetReference"
					},
					"name": "StoreToDatabase"
				}
			],
			"transformations": [
				{
					"name": "JsonToTabularFormat"
				},
				{
					"name": "RemoveNullValuesFromId"
				},
				{
					"name": "ConvertDatesFromStringToDate"
				}
			],
			"script": "source(output(\n\t\tLead as ({@xsi:type} as string, ARIS_Trial_Logins_Lead__c as string, Account_EmployeesRange__c as string, Age_LastActivity__c as double, Age_LastModified__c as double, Annual_Revenue_Range__c as string, Classification_SolutionType__c as string, Company as string, ConvertedContactId as string, ConvertedDate as date, Country as string, CreatedDate as string, CurrencyIsoCode as string, Customer_Segmentation__c as string, DUNS_Number__c as integer, Domestic_Ultimate_DUNS_Number__c as integer, Id as string, Incremental__c as boolean, Industry as string, Industry_Sub__c as string, Job_Title_Standardized__c as string, LastActivityDate as date, LastModifiedDate as string, Lead_BU_Playbook__c as string, Link_Account__c as string, MQL_Date__c as string, Most_Recent_Campaign_Date__c as string, Most_Recent_Campaign_Sales_Playbook__c as string, Most_Recent_Campaign_Status__c as string, Most_Recent_Campaign__c as string, Most_Recent_MQL_Date__c as string, Most_Recent_Sales_Play_Campaign__c as string, NumberOfEmployees as integer, OwnerId as string, Partner_Involved__c as boolean, Partner_Lead__c as boolean, Qualification_Date_FirstContact__c as date, Qualification_DisregardedReason__c as string, RecordTypeId as string, SAG_Organization__c as string, Sales_Region__c as string, Sales_Sub_Region__c as string, State as string, Status as string, Title as string, accountBuyingStage6sense_INT__c as string, accountBuyingStage6sense_IoT__c as string, accountIntentScore6sense_INT__c as double, accountIntentScore6sense_IoT__c as double, accountProfileFit6sense_INT__c as string, accountProfileFit6sense_IoT__c as string, bizible2__Account__c as string, bizible2__Ad_Campaign_Name_FT__c as string, bizible2__Ad_Campaign_Name_LC__c as string, bizible2__BizibleId__c as string, bizible2__Landing_Page_FT__c as string, bizible2__Landing_Page_LC__c as string, bizible2__Marketing_Channel_FT__c as string, bizible2__Marketing_Channel_LC__c as string, bizible2__Touchpoint_Date_FT__c as string, bizible2__Touchpoint_Date_LC__c as string, bizible2__Touchpoint_Source_FT__c as string, bizible2__Touchpoint_Source_LC__c as string, {ens:type} as string, mkto71_Lead_Score__c as double)[]\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'IngestionDate',\n\tdocumentForm: 'documentPerLine') ~> SalesforceLeadsFromBlob\nSalesforceLeadsFromBlob foldDown(unroll(Lead),\n\tmapColumn(\n\t\tARIS_Trial_Logins_Lead__c = Lead.ARIS_Trial_Logins_Lead__c,\n\t\tAccount_AnnualRevRange_LocalCurr__c = Lead.Account_AnnualRevRange_LocalCurr__c,\n\t\tAccount_EmployeesRange__c = Lead.Account_EmployeesRange__c,\n\t\tAccount_Owner_Role__c = Lead.Account_Owner_Role__c,\n\t\tActivity_after_MQL__c = Lead.Activity_after_MQL__c,\n\t\tAddress_Visit_Country__c = Lead.Address_Visit_Country__c,\n\t\tAge_LastActivity__c = Lead.Age_LastActivity__c,\n\t\tAge_LastModified__c = Lead.Age_LastModified__c,\n\t\tAnnual_Revenue_Range__c = Lead.Annual_Revenue_Range__c,\n\t\tAsset__c = Lead.Asset__c,\n\t\tBehavior_Score__c = Lead.Behavior_Score__c,\n\t\tClassification_SolutionType__c = Lead.Classification_SolutionType__c,\n\t\tCluster__c = Lead.Cluster__c,\n\t\tCompany = Lead.Company,\n\t\tContact_DepartmentType__c = Lead.Contact_DepartmentType__c,\n\t\tConvertedAccountId = Lead.ConvertedAccountId,\n\t\tConvertedContactId = Lead.ConvertedContactId,\n\t\tConvertedDate = Lead.ConvertedDate,\n\t\tConvertedOpportunityId = Lead.ConvertedOpportunityId,\n\t\tCountry = Lead.Country,\n\t\tCreatedById = Lead.CreatedById,\n\t\tCreatedDate = Lead.CreatedDate,\n\t\tCurrencyIsoCode = Lead.CurrencyIsoCode,\n\t\tCurrent_MQL_ID__c = Lead.Current_MQL_ID__c,\n\t\tCustomer_Segmentation__c = Lead.Customer_Segmentation__c,\n\t\tDNBoptimizer__DNB_D_U_N_S_Number__c = Lead.DNBoptimizer__DNB_D_U_N_S_Number__c,\n\t\tDNBoptimizer__DnBCompanyRecord__c = Lead.DNBoptimizer__DnBCompanyRecord__c,\n\t\tDNBoptimizer__DnBContactRecord__c = Lead.DNBoptimizer__DnBContactRecord__c,\n\t\tDUNS_Number__c = Lead.DUNS_Number__c,\n\t\tDemographic_Score__c = Lead.Demographic_Score__c,\n\t\tDivision__c = Lead.Division__c,\n\t\tDomestic_Ultimate_DUNS_Number__c = Lead.Domestic_Ultimate_DUNS_Number__c,\n\t\tId = Lead.Id,\n\t\tIncremental__c = Lead.Incremental__c,\n\t\tIndustry = Lead.Industry,\n\t\tIndustry_Sub__c = Lead.Industry_Sub__c,\n\t\tJob_Title_Standardized__c = Lead.Job_Title_Standardized__c,\n\t\tKeyWords__c = Lead.KeyWords__c,\n\t\tLastActivityDate = Lead.LastActivityDate,\n\t\tLastModifiedDate = Lead.LastModifiedDate,\n\t\tLastTransferDate = Lead.LastTransferDate,\n\t\tLead_BU_Playbook__c = Lead.Lead_BU_Playbook__c,\n\t\tLink_Account__c = Lead.Link_Account__c,\n\t\tMQL_Date__c = Lead.MQL_Date__c,\n\t\tMarketo_Do_Not_Sync__c = Lead.Marketo_Do_Not_Sync__c,\n\t\tMasterRecordId = Lead.MasterRecordId,\n\t\tMost_Recent_Campaign_Date__c = Lead.Most_Recent_Campaign_Date__c,\n\t\tMost_Recent_Campaign_Sales_Playbook__c = Lead.Most_Recent_Campaign_Sales_Playbook__c,\n\t\tMost_Recent_Campaign_Status__c = Lead.Most_Recent_Campaign_Status__c,\n\t\tMost_Recent_Campaign__c = Lead.Most_Recent_Campaign__c,\n\t\tMost_Recent_MQL_Date__c = Lead.Most_Recent_MQL_Date__c,\n\t\tMost_Recent_Sales_Play_Campaign__c = Lead.Most_Recent_Sales_Play_Campaign__c,\n\t\tNumberOfEmployees = Lead.NumberOfEmployees,\n\t\tOpportunity_Name__c = Lead.Opportunity_Name__c,\n\t\tOutreach_Actively_being_sequenced__c = Lead.Outreach_Actively_being_sequenced__c,\n\t\tOutreach_Date_Added_to_Sequence__c = Lead.Outreach_Date_Added_to_Sequence__c,\n\t\tOutreach_Finished_Sequences__c = Lead.Outreach_Finished_Sequences__c,\n\t\tOutreach_Number_of_Active_Sequences__c = Lead.Outreach_Number_of_Active_Sequences__c,\n\t\tOutreach_Number_of_Active_Tasks__c = Lead.Outreach_Number_of_Active_Tasks__c,\n\t\tOwnerId = Lead.OwnerId,\n\t\tPartner_Involved__c = Lead.Partner_Involved__c,\n\t\tPartner_Lead__c = Lead.Partner_Lead__c,\n\t\tQualification_Date_FirstContact__c = Lead.Qualification_Date_FirstContact__c,\n\t\tQualification_DisregardedReason__c = Lead.Qualification_DisregardedReason__c,\n\t\tRecordTypeId = Lead.RecordTypeId,\n\t\tSAG_Organization__c = Lead.SAG_Organization__c,\n\t\tSAG_User_Groups__c = Lead.SAG_User_Groups__c,\n\t\tSales_Region__c = Lead.Sales_Region__c,\n\t\tSales_Sub_Region__c = Lead.Sales_Sub_Region__c,\n\t\tState = Lead.State,\n\t\tStatus = Lead.Status,\n\t\tTitle = Lead.Title,\n\t\tTop_Account__c = Lead.Top_Account__c,\n\t\tWorkspan_ID__c = Lead.Workspan_ID__c,\n\t\tWorkspan_URL__c = Lead.Workspan_URL__c,\n\t\taccountBuyingStage6sense_INT__c = Lead.accountBuyingStage6sense_INT__c,\n\t\taccountBuyingStage6sense_IoT__c = Lead.accountBuyingStage6sense_IoT__c,\n\t\taccountIntentScore6sense_INT__c = Lead.accountIntentScore6sense_INT__c,\n\t\taccountIntentScore6sense_IoT__c = Lead.accountIntentScore6sense_IoT__c,\n\t\taccountProfileFit6sense_INT__c = Lead.accountProfileFit6sense_INT__c,\n\t\taccountProfileFit6sense_IoT__c = Lead.accountProfileFit6sense_IoT__c,\n\t\tbizible2__Account__c = Lead.bizible2__Account__c,\n\t\tbizible2__Ad_Campaign_Name_FT__c = Lead.bizible2__Ad_Campaign_Name_FT__c,\n\t\tbizible2__Ad_Campaign_Name_LC__c = Lead.bizible2__Ad_Campaign_Name_LC__c,\n\t\tbizible2__BizibleId__c = Lead.bizible2__BizibleId__c,\n\t\tbizible2__Landing_Page_FT__c = Lead.bizible2__Landing_Page_FT__c,\n\t\tbizible2__Landing_Page_LC__c = Lead.bizible2__Landing_Page_LC__c,\n\t\tbizible2__Marketing_Channel_FT__c = Lead.bizible2__Marketing_Channel_FT__c,\n\t\tbizible2__Marketing_Channel_LC__c = Lead.bizible2__Marketing_Channel_LC__c,\n\t\tbizible2__Touchpoint_Date_FT__c = Lead.bizible2__Touchpoint_Date_FT__c,\n\t\tbizible2__Touchpoint_Date_LC__c = Lead.bizible2__Touchpoint_Date_LC__c,\n\t\tbizible2__Touchpoint_Source_FT__c = Lead.bizible2__Touchpoint_Source_FT__c,\n\t\tbizible2__Touchpoint_Source_LC__c = Lead.bizible2__Touchpoint_Source_LC__c,\n\t\tcontactGrade6sense_INT__c = Lead.contactGrade6sense_INT__c,\n\t\tcontactGrade_IoT__c = Lead.contactGrade_IoT__c,\n\t\tcontactIntentScore6sense_INT__c = Lead.contactIntentScore6sense_INT__c,\n\t\tcontactIntentScore6sense_IoT__c = Lead.contactIntentScore6sense_IoT__c,\n\t\tcontactProfileFit6sense_INT__c = Lead.contactProfileFit6sense_INT__c,\n\t\tcontactProfileFit6sense_IoT__c = Lead.contactProfileFit6sense_IoT__c,\n\t\tmkto71_Lead_Score__c = Lead.mkto71_Lead_Score__c,\n\t\tIngestionDate\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> JsonToTabularFormat\nJsonToTabularFormat filter(not(isNull(Id))) ~> RemoveNullValuesFromId\nRemoveNullValuesFromId derive(IngestionDate = toDate(split(split(IngestionDate, '/')[6],'_')[1]),\n\t\tCreatedDate = toDate(CreatedDate),\n\t\tLastModifiedDate = toDate(LastModifiedDate),\n\t\tMQL_Date__c = toDate(MQL_Date__c),\n\t\tMost_Recent_Campaign_Date__c = toDate(Most_Recent_Campaign_Date__c),\n\t\tMost_Recent_MQL_Date__c = toDate(Most_Recent_MQL_Date__c),\n\t\tbizible2__Touchpoint_Date_FT__c = toDate(bizible2__Touchpoint_Date_FT__c),\n\t\tbizible2__Touchpoint_Date_LC__c = toDate(bizible2__Touchpoint_Date_LC__c)) ~> ConvertDatesFromStringToDate\nConvertDatesFromStringToDate sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> StoreToDatabase"
		}
	}
}