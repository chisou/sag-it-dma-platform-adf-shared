{
	"name": "IngestSalesforceContactToStagingInInitialLoad",
	"properties": {
		"folder": {
			"name": "Salesforce"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "SalesforceContactFromBlob",
						"type": "DatasetReference"
					},
					"name": "SalesforceContactsFromBlob"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "StgSfContactToStagingIn",
						"type": "DatasetReference"
					},
					"name": "StoreToDatabase"
				}
			],
			"transformations": [
				{
					"name": "JsonToTabularFormat"
				},
				{
					"name": "RemoveNullValuesFromId"
				},
				{
					"name": "ConvertDatesFromStringToDate"
				}
			],
			"script": "source(output(\n\t\tContact as ({@xsi:type} as string, ARIS_Trial_Logins_Contact__c as string, AccountId as string, Account_Country__c as string, Activity_after_MQL__c as boolean, Address_Visit_Country__c as string, Asset__c as string, Behavior_Score__c as double, Contact_DepartmentType__c as string, Contact_ID_with_18_Char__c as string, Contact_Type__c as string, CreatedDate as string, CurrencyIsoCode as string, Current_MQL_ID__c as string, DNBoptimizer__DnBContactRecord__c as string, Demographic_Score__c as double, Id as string, Industry_SDR_filter_use__c as string, Job_Title_Standardized__c as string, KeyWords__c as string, LastActivityDate as date, LastModifiedDate as string, Lead_BU_Playbook__c as string, MQL_Date__c as string, Marketing_Status__c as string, Marketo_Do_Not_Sync__c as boolean, Most_Recent_Campaign_Date__c as string, Most_Recent_Campaign_Sales_Playbook__c as string, Most_Recent_Campaign_Status__c as string, Most_Recent_Campaign__c as string, Most_Recent_MQL_Date__c as string, Outreach_Actively_Being_Sequenced__c as boolean, Outreach_Date_Added_to_Sequence__c as date, Qualified_Out_Reason__c as string, RecordTypeId as string, SAG_Organization__c as string, SAG_UserGroup__c as string, Sales_Region_Account__c as string, Sales_Sub_Region_Account__c as string, Status__c as string, Title as string, accountBuyingStage6sense_INT__c as string, accountBuyingStage6sense_IoT__c as string, accountIntentScore6sense_INT__c as string, accountIntentScore6sense_IoT__c as string, accountProfileFit6sense_INT__c as string, bizible2__Ad_Campaign_Name_FT__c as string, bizible2__Ad_Campaign_Name_LC__c as string, bizible2__BizibleId__c as string, bizible2__Landing_Page_FT__c as string, bizible2__Landing_Page_LC__c as string, bizible2__Marketing_Channel_FT__c as string, bizible2__Marketing_Channel_LC__c as string, bizible2__Touchpoint_Date_FT__c as string, bizible2__Touchpoint_Date_LC__c as string, bizible2__Touchpoint_Source_FT__c as string, bizible2__Touchpoint_Source_LC__c as string, contactGrade6sense_INT__c as string, contactGrade_IoT__c as string, contactIntentScore6sense_INT__c as string, contactIntentScore6sense_IoT__c as double, contactProfileFit6sense_INT__c as string, contactProfileFit6sense_IoT__c as string, {ens:type} as string, mkto71_Lead_Score__c as double)[]\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'IngestionDate',\n\tdocumentForm: 'documentPerLine',\n\twildcardPaths:['Salesforce/Contact/*/*/*.json']) ~> SalesforceContactsFromBlob\nSalesforceContactsFromBlob foldDown(unroll(Contact),\n\tmapColumn(\n\t\tARIS_Trial_Logins_Contact__c = Contact.ARIS_Trial_Logins_Contact__c,\n\t\tAccountId = Contact.AccountId,\n\t\tAccount_Country__c = Contact.Account_Country__c,\n\t\tActivity_after_MQL__c = Contact.Activity_after_MQL__c,\n\t\tAddress_Visit_Country__c = Contact.Address_Visit_Country__c,\n\t\tAsset__c = Contact.Asset__c,\n\t\tBehavior_Score__c = Contact.Behavior_Score__c,\n\t\tContact_DepartmentType__c = Contact.Contact_DepartmentType__c,\n\t\tContact_ID_with_18_Char__c = Contact.Contact_ID_with_18_Char__c,\n\t\tContact_Type__c = Contact.Contact_Type__c,\n\t\tCreatedDate = Contact.CreatedDate,\n\t\tCurrencyIsoCode = Contact.CurrencyIsoCode,\n\t\tCurrent_MQL_ID__c = Contact.Current_MQL_ID__c,\n\t\tDNBoptimizer__DnBContactRecord__c = Contact.DNBoptimizer__DnBContactRecord__c,\n\t\tDemographic_Score__c = Contact.Demographic_Score__c,\n\t\tId = Contact.Id,\n\t\tIndustry_SDR_filter_use__c = Contact.Industry_SDR_filter_use__c,\n\t\tJob_Title_Standardized__c = Contact.Job_Title_Standardized__c,\n\t\tKeyWords__c = Contact.KeyWords__c,\n\t\tLastActivityDate = Contact.LastActivityDate,\n\t\tLastModifiedDate = Contact.LastModifiedDate,\n\t\tLead_BU_Playbook__c = Contact.Lead_BU_Playbook__c,\n\t\tMQL_Date__c = Contact.MQL_Date__c,\n\t\tMarketing_Status__c = Contact.Marketing_Status__c,\n\t\tMarketo_Do_Not_Sync__c = Contact.Marketo_Do_Not_Sync__c,\n\t\tMost_Recent_Campaign_Date__c = Contact.Most_Recent_Campaign_Date__c,\n\t\tMost_Recent_Campaign_Sales_Playbook__c = Contact.Most_Recent_Campaign_Sales_Playbook__c,\n\t\tMost_Recent_Campaign_Status__c = Contact.Most_Recent_Campaign_Status__c,\n\t\tMost_Recent_Campaign__c = Contact.Most_Recent_Campaign__c,\n\t\tMost_Recent_MQL_Date__c = Contact.Most_Recent_MQL_Date__c,\n\t\tOutreach_Actively_Being_Sequenced__c = Contact.Outreach_Actively_Being_Sequenced__c,\n\t\tOutreach_Date_Added_to_Sequence__c = Contact.Outreach_Date_Added_to_Sequence__c,\n\t\tQualified_Out_Reason__c = Contact.Qualified_Out_Reason__c,\n\t\tRecordTypeId = Contact.RecordTypeId,\n\t\tSAG_Organization__c = Contact.SAG_Organization__c,\n\t\tSAG_UserGroup__c = Contact.SAG_UserGroup__c,\n\t\tSales_Region_Account__c = Contact.Sales_Region_Account__c,\n\t\tSales_Sub_Region_Account__c = Contact.Sales_Sub_Region_Account__c,\n\t\tStatus__c = Contact.Status__c,\n\t\tTitle = Contact.Title,\n\t\taccountBuyingStage6sense_INT__c = Contact.accountBuyingStage6sense_INT__c,\n\t\taccountBuyingStage6sense_IoT__c = Contact.accountBuyingStage6sense_IoT__c,\n\t\taccountIntentScore6sense_INT__c = Contact.accountIntentScore6sense_INT__c,\n\t\taccountIntentScore6sense_IoT__c = Contact.accountIntentScore6sense_IoT__c,\n\t\taccountProfileFit6sense_INT__c = Contact.accountProfileFit6sense_INT__c,\n\t\tbizible2__Ad_Campaign_Name_FT__c = Contact.bizible2__Ad_Campaign_Name_FT__c,\n\t\tbizible2__Ad_Campaign_Name_LC__c = Contact.bizible2__Ad_Campaign_Name_LC__c,\n\t\tbizible2__BizibleId__c = Contact.bizible2__BizibleId__c,\n\t\tbizible2__Landing_Page_FT__c = Contact.bizible2__Landing_Page_FT__c,\n\t\tbizible2__Landing_Page_LC__c = Contact.bizible2__Landing_Page_LC__c,\n\t\tbizible2__Marketing_Channel_FT__c = Contact.bizible2__Marketing_Channel_FT__c,\n\t\tbizible2__Marketing_Channel_LC__c = Contact.bizible2__Marketing_Channel_LC__c,\n\t\tbizible2__Touchpoint_Date_FT__c = Contact.bizible2__Touchpoint_Date_FT__c,\n\t\tbizible2__Touchpoint_Date_LC__c = Contact.bizible2__Touchpoint_Date_LC__c,\n\t\tbizible2__Touchpoint_Source_FT__c = Contact.bizible2__Touchpoint_Source_FT__c,\n\t\tbizible2__Touchpoint_Source_LC__c = Contact.bizible2__Touchpoint_Source_LC__c,\n\t\tcontactGrade6sense_INT__c = Contact.contactGrade6sense_INT__c,\n\t\tcontactGrade_IoT__c = Contact.contactGrade_IoT__c,\n\t\tcontactIntentScore6sense_INT__c = Contact.contactIntentScore6sense_INT__c,\n\t\tcontactIntentScore6sense_IoT__c = Contact.contactIntentScore6sense_IoT__c,\n\t\tcontactProfileFit6sense_INT__c = Contact.contactProfileFit6sense_INT__c,\n\t\tcontactProfileFit6sense_IoT__c = Contact.contactProfileFit6sense_IoT__c,\n\t\tmkto71_Lead_Score__c = Contact.mkto71_Lead_Score__c,\n\t\tIngestionDate\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> JsonToTabularFormat\nJsonToTabularFormat filter(not(isNull(Id))) ~> RemoveNullValuesFromId\nRemoveNullValuesFromId derive(IngestionDate = toDate(split(split(IngestionDate, '/')[6],'_')[1]),\n\t\tCreatedDate = toDate(CreatedDate),\n\t\tLastModifiedDate = toDate(LastModifiedDate),\n\t\tMQL_Date__c = toDate(MQL_Date__c),\n\t\tMost_Recent_Campaign_Date__c = toDate(Most_Recent_Campaign_Date__c),\n\t\tMost_Recent_MQL_Date__c = toDate(Most_Recent_MQL_Date__c),\n\t\tbizible2__Touchpoint_Date_FT__c = toDate(bizible2__Touchpoint_Date_FT__c),\n\t\tbizible2__Touchpoint_Date_LC__c = toDate(bizible2__Touchpoint_Date_LC__c)) ~> ConvertDatesFromStringToDate\nConvertDatesFromStringToDate sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> StoreToDatabase"
		}
	}
}